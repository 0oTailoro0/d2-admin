# Vue.$import

本框架集成了数据导入功能，并包装成插件

## 注册插件

> 默认已经注册，可以直接使用

```
import pluginImport from '@/plugin/import'
Vue.use(pluginImport)
```

之后就可以在组件中使用 `this.$import` 来调用导出功能

## Vue.$import.csv()

导入csv文件，并且返回一个 `Promise` 对象

参数

| 参数名 | 介绍 | 必选 | 值类型 | 可选值 | 默认值 |
| --- | --- | --- | --- | --- | --- |
| file | 选择的文件 | 是 | File |  |  |

使用

```
// 在选择文件后调用
handleUpload (file) {
  this.$import.csv(file)
    .then(res => {
      this.table.columns = Object.keys(res.data[0]).map(e => ({
        label: e,
        prop: e
      }))
      this.table.data = res.data
    })
  // 阻止默认的上传
  return false
}
```

## Vue.$import.xlsx()

导入xlsx文件，并且返回一个 `Promise` 对象

参数

| 参数名 | 介绍 | 必选 | 值类型 | 可选值 | 默认值 |
| --- | --- | --- | --- | --- | --- |
| file | 选择的文件 | 是 | File |  |  |

使用

```
// 在选择文件后调用
handleUpload (file) {
  this.$import.xlsx(file)
    .then(({header, results}) => {
      this.table.columns = header.map(e => {
        return {
          label: e,
          prop: e
        }
      })
      this.table.data = results
    })
  // 阻止默认的上传
  return false
}
```